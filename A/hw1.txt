Karen@Karen-PC ~/courses/NumericalAnalysis/A
$ cat polyinterop.hs
import Text.Printf


f x = 1/(1+x^2)

pts::Int->[Double]
pts n = [fromIntegral i/fromIntegral n*10-5|i<-[0..n]]

l::Int->(Int->Double)->Int->Double->Double
l n xs k x = product [(x-xs i)/(xs k-xs i)|i<-[0..(k-1)]++[(k+1)..n]]

l'::Int->Double->(Int->Double)->(Int->Double)->Double
l' n x xs ys = sum [ys k*l n xs k x|k<-[0..n]]


p::Int->Double->Double
p n x = l' n x xs ys where
        xs = (pts n!!)
        ys = f.xs

main = putStrLn $ unlines [test (n::Int)|n<-[4,8,16]] where
        testxs = pts 32::[Double]
        test n = printf "N=%d\n" n ++ unlines [concat (map prt [x, p n x, f x])|x<-testxs]
--              [ concat [prt x|x<-testxs] , concat [prt (p n x)|x<-testxs], concat [prt (f x)|x<-testxs] ]
        prt = printf "%.3f\t"

Karen@Karen-PC ~/courses/NumericalAnalysis/A
$ runghc polyinterop.hs
N=4
-5.000  0.038   0.038
-4.688  -0.198  0.044
-4.375  -0.331  0.050
-4.063  -0.379  0.057
-3.750  -0.357  0.066
-3.438  -0.281  0.078
-3.125  -0.165  0.093
-2.813  -0.021  0.112
-2.500  0.138   0.138
-2.188  0.303   0.173
-1.875  0.464   0.221
-1.563  0.614   0.291
-1.250  0.746   0.390
-0.938  0.854   0.532
-0.625  0.934   0.719
-0.313  0.983   0.911
0.000   1.000   1.000
0.313   0.983   0.911
0.625   0.934   0.719
0.938   0.854   0.532
1.250   0.746   0.390
1.563   0.614   0.291
1.875   0.464   0.221
2.188   0.303   0.173
2.500   0.138   0.138
2.813   -0.021  0.112
3.125   -0.165  0.093
3.438   -0.281  0.078
3.750   -0.357  0.066
4.063   -0.379  0.057
4.375   -0.331  0.050
4.688   -0.198  0.044
5.000   0.038   0.038

N=8
-5.000  0.038   0.038
-4.688  -0.967  0.044
-4.375  -0.831  0.050
-4.063  -0.355  0.057
-3.750  0.066   0.066
-3.438  0.292   0.078
-3.125  0.328   0.093
-2.813  0.247   0.112
-2.500  0.138   0.138
-2.188  0.072   0.173
-1.875  0.092   0.221
-1.563  0.205   0.291
-1.250  0.390   0.390
-0.938  0.607   0.532
-0.625  0.808   0.719
-0.313  0.949   0.911
0.000   1.000   1.000
0.313   0.949   0.911
0.625   0.808   0.719
0.938   0.607   0.532
1.250   0.390   0.390
1.563   0.205   0.291
1.875   0.092   0.221
2.188   0.072   0.173
2.500   0.138   0.138
2.813   0.247   0.112
3.125   0.328   0.093
3.438   0.292   0.078
3.750   0.066   0.066
4.063   -0.355  0.057
4.375   -0.831  0.050
4.688   -0.967  0.044
5.000   0.038   0.038

N=16
-5.000  0.038   0.038
-4.688  -10.174 0.044
-4.375  0.050   0.050
-4.063  1.182   0.057
-3.750  0.066   0.066
-3.438  -0.146  0.078
-3.125  0.093   0.093
-2.813  0.181   0.112
-2.500  0.138   0.138
-2.188  0.143   0.173
-1.875  0.221   0.221
-1.563  0.308   0.291
-1.250  0.390   0.390
-0.938  0.521   0.532
-0.625  0.719   0.719
-0.313  0.916   0.911
0.000   1.000   1.000
0.313   0.916   0.911
0.625   0.719   0.719
0.938   0.521   0.532
1.250   0.390   0.390
1.563   0.308   0.291
1.875   0.221   0.221
2.188   0.143   0.173
2.500   0.138   0.138
2.813   0.181   0.112
3.125   0.093   0.093
3.438   -0.146  0.078
3.750   0.066   0.066
4.063   1.182   0.057
4.375   0.050   0.050
4.688   -10.174 0.044
5.000   0.038   0.038